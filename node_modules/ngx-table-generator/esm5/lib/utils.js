/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
var TableUtils = /** @class */ (function () {
    function TableUtils() {
    }
    /**
     * @param {?} array
     * @param {?} value
     * @return {?}
     */
    TableUtils.prototype.deleteInstance = /**
     * @param {?} array
     * @param {?} value
     * @return {?}
     */
    function (array, value) {
        for (var i = 0; i < array.length; i++) {
            if (value === array[i]) {
                array.splice(i, 1);
                break;
            }
        }
        return array;
    };
    /**
     * @param {?} data
     * @param {?} arrayData
     * @param {?} id
     * @return {?}
     */
    TableUtils.prototype.chargeMultiCheckArray = /**
     * @param {?} data
     * @param {?} arrayData
     * @param {?} id
     * @return {?}
     */
    function (data, arrayData, id) {
        /** @type {?} */
        var array = [];
        var _loop_1 = function (i) {
            arrayData.map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item === data[i][id]) {
                    array[i] = true;
                }
            }));
        };
        for (var i = 0; i < data.length; i++) {
            _loop_1(i);
        }
        return array;
    };
    /**
     * @param {?} val
     * @param {?} decimals
     * @return {?}
     */
    TableUtils.prototype.transformToNumber = /**
     * @param {?} val
     * @param {?} decimals
     * @return {?}
     */
    function (val, decimals) {
        if (val !== undefined && val !== null) {
            decimals = decimals || decimals === 0 ? decimals : 2;
            if (isNaN(val)) {
                return val;
            }
            else {
                val = val.toLocaleString('es-ES', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
                if (val.includes(',')) {
                    val = this.covertMillarWithDecimalToSpanish(val);
                }
                else {
                    val = this.convertMillarToSpanish(val);
                }
                return val;
            }
        }
        else {
            return '';
        }
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    TableUtils.prototype.convertMillarToSpanish = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        /** @type {?} */
        var splitVal = val.split('');
        if (splitVal.length === 4) {
            splitVal.splice(1, 0, '.');
        }
        val = '';
        splitVal.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            val += element;
        }));
        return val;
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    TableUtils.prototype.covertMillarWithDecimalToSpanish = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        /** @type {?} */
        var splitVal = val.split(',');
        if (splitVal[0].length === 4) {
            /** @type {?} */
            var naturalNum = splitVal[0];
            splitVal[0] = '';
            naturalNum = naturalNum.split('');
            naturalNum.splice(1, 0, '.');
            naturalNum.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                splitVal[0] += element;
            }));
            val = splitVal[0] + "," + splitVal[1];
        }
        return val;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    TableUtils.prototype.copyArray = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        var _this = this;
        /** @type {?} */
        var result = null;
        if (!item) {
            return result;
        }
        if (Array.isArray(item)) {
            result = [];
            item.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                result.push(_this.copyArray(element));
            }));
        }
        else if (item instanceof Object && !(item instanceof Function)) {
            result = {};
            for (var key in item) {
                if (key) {
                    result[key] = this.copyArray(item[key]);
                }
            }
        }
        return result || item;
    };
    /**
     * @param {?} conditionalMulticheck
     * @param {?} keysMulticheck
     * @param {?} valueMulticheckToCompare
     * @param {?} data
     * @return {?}
     */
    TableUtils.prototype.chargeShowMulticheck = /**
     * @param {?} conditionalMulticheck
     * @param {?} keysMulticheck
     * @param {?} valueMulticheckToCompare
     * @param {?} data
     * @return {?}
     */
    function (conditionalMulticheck, keysMulticheck, valueMulticheckToCompare, data) {
        var _this = this;
        /** @type {?} */
        var showArray = [];
        data.forEach((/**
         * @param {?} element
         * @param {?} index
         * @return {?}
         */
        function (element, index) {
            showArray[index] = true;
        }));
        if (conditionalMulticheck && keysMulticheck && valueMulticheckToCompare) {
            var _loop_2 = function (i) {
                data.forEach((/**
                 * @param {?} element
                 * @param {?} index
                 * @return {?}
                 */
                function (element, index) {
                    if (!_this.suboperationConditional(conditionalMulticheck[i], valueMulticheckToCompare[i], element[keysMulticheck[i]])
                        && showArray[index]) {
                        showArray[index] = false;
                    }
                }));
            };
            for (var i = 0; i < keysMulticheck.length; i++) {
                _loop_2(i);
            }
        }
        return showArray;
    };
    /**
     * @param {?} conditional
     * @param {?} valueToCompare
     * @param {?} value
     * @return {?}
     */
    TableUtils.prototype.suboperationConditional = /**
     * @param {?} conditional
     * @param {?} valueToCompare
     * @param {?} value
     * @return {?}
     */
    function (conditional, valueToCompare, value) {
        switch (conditional) {
            case '<':
                return parseFloat(value) < parseFloat(valueToCompare);
            case '>':
                return parseFloat(value) > parseFloat(valueToCompare);
            case '===':
                return (value || value === 0 || value === false ? value.toString() : value) ===
                    (valueToCompare || valueToCompare === 0 || valueToCompare === false ? valueToCompare.toString() : valueToCompare);
            case '>=':
                return value >= valueToCompare;
            case '<=':
                return value <= valueToCompare;
            case '<day':
                return (new Date(value).setHours(0) - new Date().setHours(0, 0, 0, 0)) < 0;
            case '>day':
                return (new Date(value).setHours(0) - new Date().setHours(0, 0, 0, 0)) > 0;
        }
    };
    TableUtils.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */ TableUtils.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function TableUtils_Factory() { return new TableUtils(); }, token: TableUtils, providedIn: "root" });
    return TableUtils;
}());
export { TableUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtdGFibGUtZ2VuZXJhdG9yLyIsInNvdXJjZXMiOlsibGliL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7QUFFM0M7SUFBQTtLQW1JQzs7Ozs7O0lBL0hVLG1DQUFjOzs7OztJQUFyQixVQUFzQixLQUFLLEVBQUUsS0FBSztRQUM5QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNuQyxJQUFJLEtBQUssS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3BCLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNuQixNQUFNO2FBQ1Q7U0FDSjtRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7Ozs7Ozs7SUFFTSwwQ0FBcUI7Ozs7OztJQUE1QixVQUE2QixJQUFJLEVBQUUsU0FBUyxFQUFFLEVBQUU7O1lBQ3RDLEtBQUssR0FBRyxFQUFFO2dDQUNQLENBQUM7WUFDTixTQUFTLENBQUMsR0FBRzs7OztZQUFDLFVBQUMsSUFBSTtnQkFDZixJQUFJLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7b0JBQ3RCLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7aUJBQ25CO1lBQ0wsQ0FBQyxFQUFDLENBQUM7O1FBTFAsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFO29CQUEzQixDQUFDO1NBTVQ7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDOzs7Ozs7SUFFTSxzQ0FBaUI7Ozs7O0lBQXhCLFVBQXlCLEdBQUcsRUFBRSxRQUFRO1FB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QVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUNsRjtJQUNMLENBQUM7O2dCQWxJSixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7cUJBSkQ7Q0FxSUMsQUFuSUQsSUFtSUM7U0FoSVksVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICAgIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgVGFibGVVdGlscyB7XHJcbiAgICBwdWJsaWMgZGVsZXRlSW5zdGFuY2UoYXJyYXksIHZhbHVlKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IGFycmF5W2ldKSB7XHJcbiAgICAgICAgICAgICAgICBhcnJheS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyYXk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNoYXJnZU11bHRpQ2hlY2tBcnJheShkYXRhLCBhcnJheURhdGEsIGlkKSB7XHJcbiAgICAgICAgY29uc3QgYXJyYXkgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYXJyYXlEYXRhLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT09IGRhdGFbaV1baWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlbaV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0cmFuc2Zvcm1Ub051bWJlcih2YWwsIGRlY2ltYWxzKSB7XHJcbiAgICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkICYmIHZhbCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkZWNpbWFscyA9IGRlY2ltYWxzIHx8IGRlY2ltYWxzID09PSAwID8gZGVjaW1hbHMgOiAyO1xyXG4gICAgICAgICAgICBpZiAoaXNOYU4odmFsKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbCA9IHZhbC50b0xvY2FsZVN0cmluZygnZXMtRVMnLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMsIG1heGltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsLmluY2x1ZGVzKCcsJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLmNvdmVydE1pbGxhcldpdGhEZWNpbWFsVG9TcGFuaXNoKHZhbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHRoaXMuY29udmVydE1pbGxhclRvU3BhbmlzaCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb252ZXJ0TWlsbGFyVG9TcGFuaXNoKHZhbDogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc3BsaXRWYWwgPSB2YWwuc3BsaXQoJycpO1xyXG4gICAgICAgIGlmIChzcGxpdFZhbC5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICAgICAgc3BsaXRWYWwuc3BsaWNlKDEsIDAsICcuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbCA9ICcnO1xyXG4gICAgICAgIHNwbGl0VmFsLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHZhbCArPSBlbGVtZW50O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb3ZlcnRNaWxsYXJXaXRoRGVjaW1hbFRvU3BhbmlzaCh2YWw6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHNwbGl0VmFsID0gdmFsLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgaWYgKHNwbGl0VmFsWzBdLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgICAgICBsZXQgbmF0dXJhbE51bSA9IHNwbGl0VmFsWzBdO1xyXG4gICAgICAgICAgICBzcGxpdFZhbFswXSA9ICcnO1xyXG4gICAgICAgICAgICBuYXR1cmFsTnVtID0gbmF0dXJhbE51bS5zcGxpdCgnJyk7XHJcbiAgICAgICAgICAgIG5hdHVyYWxOdW0uc3BsaWNlKDEsIDAsICcuJyk7XHJcbiAgICAgICAgICAgIG5hdHVyYWxOdW0uZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIHNwbGl0VmFsWzBdICs9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YWwgPSBgJHtzcGxpdFZhbFswXX0sJHtzcGxpdFZhbFsxXX1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjb3B5QXJyYXkoaXRlbSkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIGlmICghaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgaXRlbS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh0aGlzLmNvcHlBcnJheShlbGVtZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhKGl0ZW0gaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IHRoaXMuY29weUFycmF5KGl0ZW1ba2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCBpdGVtO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjaGFyZ2VTaG93TXVsdGljaGVjayhjb25kaXRpb25hbE11bHRpY2hlY2ssIGtleXNNdWx0aWNoZWNrLCB2YWx1ZU11bHRpY2hlY2tUb0NvbXBhcmUsIGRhdGEpIHtcclxuICAgICAgICBjb25zdCBzaG93QXJyYXkgPSBbXTtcclxuICAgICAgICBkYXRhLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIHNob3dBcnJheVtpbmRleF0gPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChjb25kaXRpb25hbE11bHRpY2hlY2sgJiYga2V5c011bHRpY2hlY2sgJiYgdmFsdWVNdWx0aWNoZWNrVG9Db21wYXJlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5c011bHRpY2hlY2subGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3Vib3BlcmF0aW9uQ29uZGl0aW9uYWwoY29uZGl0aW9uYWxNdWx0aWNoZWNrW2ldLCB2YWx1ZU11bHRpY2hlY2tUb0NvbXBhcmVbaV0sIGVsZW1lbnRba2V5c011bHRpY2hlY2tbaV1dKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBzaG93QXJyYXlbaW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBcnJheVtpbmRleF0gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNob3dBcnJheTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3Vib3BlcmF0aW9uQ29uZGl0aW9uYWwoY29uZGl0aW9uYWwsIHZhbHVlVG9Db21wYXJlLCB2YWx1ZSkge1xyXG4gICAgICAgIHN3aXRjaCAoY29uZGl0aW9uYWwpIHtcclxuICAgICAgICAgICAgY2FzZSAnPCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPCBwYXJzZUZsb2F0KHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPiBwYXJzZUZsb2F0KHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPT09JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiAodmFsdWUgfHwgdmFsdWUgPT09IDAgfHwgdmFsdWUgPT09IGZhbHNlID8gdmFsdWUudG9TdHJpbmcoKSA6IHZhbHVlKSA9PT1cclxuICAgICAgICAgICAgICAgICAgICAodmFsdWVUb0NvbXBhcmUgfHwgdmFsdWVUb0NvbXBhcmUgPT09IDAgfHwgdmFsdWVUb0NvbXBhcmUgPT09IGZhbHNlID8gdmFsdWVUb0NvbXBhcmUudG9TdHJpbmcoKSA6IHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPj0nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID49IHZhbHVlVG9Db21wYXJlO1xyXG4gICAgICAgICAgICBjYXNlICc8PSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPD0gdmFsdWVUb0NvbXBhcmU7XHJcbiAgICAgICAgICAgIGNhc2UgJzxkYXknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSh2YWx1ZSkuc2V0SG91cnMoMCkgLSBuZXcgRGF0ZSgpLnNldEhvdXJzKDAsIDAsIDAsIDApKSA8IDA7XHJcbiAgICAgICAgICAgIGNhc2UgJz5kYXknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSh2YWx1ZSkuc2V0SG91cnMoMCkgLSBuZXcgRGF0ZSgpLnNldEhvdXJzKDAsIDAsIDAsIDApKSA+IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==