!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/material"),require("@angular/common"),require("ngx-spanish-pipe")):"function"==typeof define&&define.amd?define("ngx-table-generator",["exports","@angular/core","@angular/material","@angular/common","ngx-spanish-pipe"],e):e((t=t||self)["ngx-table-generator"]={},t.ng.core,t.ng.material,t.ng.common,t.ngxSpanishPipe)}(this,(function(t,e,n,o,a){"use strict";var i=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),r=function(){function t(){}return t.prototype.deleteInstance=function(t,e){for(var n=0;n<t.length;n++)if(e===t[n]){t.splice(n,1);break}return t},t.prototype.chargeMultiCheckArray=function(t,e,n){for(var o=[],a=function(a){e.map((function(e){e===t[a][n]&&(o[a]=!0)}))},i=0;i<t.length;i++)a(i);return o},t.prototype.transformToNumber=function(t,e){return null!=t?(e=e||0===e?e:2,isNaN(t)?t:t=(t=t.toLocaleString("es-ES",{minimumFractionDigits:e,maximumFractionDigits:e})).includes(",")?this.covertMillarWithDecimalToSpanish(t):this.convertMillarToSpanish(t)):""},t.prototype.convertMillarToSpanish=function(t){var e=t.split("");return 4===e.length&&e.splice(1,0,"."),t="",e.forEach((function(e){t+=e})),t},t.prototype.covertMillarWithDecimalToSpanish=function(t){var e=t.split(",");if(4===e[0].length){var n=e[0];e[0]="",(n=n.split("")).splice(1,0,"."),n.forEach((function(t){e[0]+=t})),t=e[0]+","+e[1]}return t},t.prototype.copyArray=function(t){var e=this,n=null;if(!t)return n;if(Array.isArray(t))n=[],t.forEach((function(t){n.push(e.copyArray(t))}));else if(t instanceof Object&&!(t instanceof Function))for(var o in n={},t)o&&(n[o]=this.copyArray(t[o]));return n||t},t.prototype.chargeShowMulticheck=function(t,e,n,o){var a=this,i=[];if(o.forEach((function(t,e){i[e]=!0})),t&&e&&n)for(var r=function(r){o.forEach((function(o,c){!a.suboperationConditional(t[r],n[r],o[e[r]])&&i[c]&&(i[c]=!1)}))},c=0;c<e.length;c++)r(c);return i},t.prototype.suboperationConditional=function(t,e,n){switch(t){case"<":return parseFloat(n)<parseFloat(e);case">":return parseFloat(n)>parseFloat(e);case"===":return(n||0===n||!1===n?n.toString():n)===(e||0===e||!1===e?e.toString():e);case">=":return n>=e;case"<=":return n<=e;case"<day":return new Date(n).setHours(0)-(new Date).setHours(0,0,0,0)<0;case">day":return new Date(n).setHours(0)-(new Date).setHours(0,0,0,0)>0}},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),c=function(){function t(t,n){this.tableUtils=t,this.datePipe=n,this.onPageEvent=new e.EventEmitter,this.buttonEvent=new e.EventEmitter,this.rowClick=new e.EventEmitter,this.sortChange=new e.EventEmitter,this.suboperationAction=new e.EventEmitter,this.trashAction=new e.EventEmitter,this.multiCheckAction=new e.EventEmitter,this.disabledMulticheck=!1,this.displayedColumns=[],this.sortOptionData=null,this.suboperationsData=null,this.isSub=!1,this.buttonOptionsData=null,this.paginatorOptionData=null,this.showNewButton=!1,this.multiCheckArray=[],this.multiCheckArrayData=[],this.decimalNum=2,this.sharesNum=0,this.suboperationsGeneratedData=[],this.showSuboperationsGeneratedData=[],this.multiMinSelected=-1,this.showMulticheck=[]}return Object.defineProperty(t.prototype,"classMap",{set:function(t){var e=this;t.map((function(t){e.classList+=t+" "}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceMap",{set:function(t){this.dataSource=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{set:function(t){this.isSub=this.isSuboperation(t),this.dataColumns=t,this.displayedColumns=this.generateDisplay(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sortOptions",{set:function(t){this.sort=new n.MatSort,this.sortOptionData={activeSort:t.activeSort||this.dataColumns[0].name,direction:t.direction||"asc"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paginatorOption",{set:function(t){this.paginatorOptionData={resultsLength:t.resultsLength||0,limit:t.limit?t.limit:20}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonOptions",{set:function(t){this.buttonOptionsData=t},enumerable:!0,configurable:!0}),t.prototype.generateDisplay=function(t){var e=[];return t.forEach((function(t){e.push(t.name)})),e},t.prototype.isSuboperation=function(t){return!(!t||"btnSuboperations"!==t[0].name)&&(t[0].suboperationData&&(this.suboperationsData=t[0].suboperationData),t[0].trashOption&&(this.trashOption=!0),t[0].multiCheck&&(this.multiCheck=t[0].multiCheck,this.multiCheckId=t[0].multiCheck.id,this.multiNameToCheck=t[0].multiCheck&&t[0].multiCheck.multiNameToCheck?t[0].multiCheck.multiNameToCheck:null,this.multiNameValue=t[0].multiCheck&&t[0].multiCheck.multiNameValue?t[0].multiCheck.multiNameValue:null,this.multiMinSelected=t[0].multiCheck&&t[0].multiCheck.multiMinSelected?t[0].multiCheck.multiMinSelected:0,this.conditionalMulticheck=t[0].multiCheck&&t[0].multiCheck.conditionalMulticheck?t[0].multiCheck.conditionalMulticheck:0,this.keysMulticheck=t[0].multiCheck&&t[0].multiCheck.keysMulticheck?t[0].multiCheck.keysMulticheck:0,this.valueMulticheckToCompare=t[0].multiCheck&&t[0].multiCheck.valueMulticheckToCompare?t[0].multiCheck.valueMulticheckToCompare:0),!0)},t.prototype.ngOnInit=function(){},t.prototype.matSortChange=function(t){this.sortChange.emit(t)},t.prototype.pageEvent=function(t){this.multiCheckArray=[],this.onPageEvent.emit(t)},t.prototype.onMultiCheckAction=function(){this.multiCheckAction.emit(this.multiCheckArrayData),this.multiCheckArrayData=[],this.multiCheckArray=[]},t.prototype.suboperationClicked=function(t,e){var n={action:t,row:e};this.suboperationAction.emit(n)},t.prototype.trashOptionAction=function(t){this.trashAction.emit(t)},t.prototype.checkSort=function(t){return t||(this.sort=new n.MatSort,this.sort.direction="asc",this.sort.active=this.sortOptionData.activeSort,this.sort)},t.prototype.getObjectToCompare=function(t,e){for(var n=0;n<e.objectToCompare.length;n++)if(e.objectToCompare[n].id===t[e.name])return this.parseToDecimal(e.objectToCompare[n].label,e)},t.prototype.ngAfterViewInit=function(){var t=this;this.sortChange.emit(this.checkSort(this.sort)),this.onPageEvent.emit(this.paginator),this.dataSource.connect&&(this.dataSourceConnect=this.dataSource.connect().subscribe((function(e){t.suboperationsData&&t.showSuboperationData(e),e&&t.multiCheck&&(t.showMultiCheckButton=!0,t.multiCheckArray=t.tableUtils.chargeMultiCheckArray(t.dataSource.data,t.multiCheckArrayData,t.multiCheck.id),e.length>0&&(t.showMulticheck=t.tableUtils.chargeShowMulticheck(t.conditionalMulticheck,t.keysMulticheck,t.valueMulticheckToCompare,t.dataSource.data)))})))},t.prototype.onRowClick=function(t,e,n){this.multiCheck&&n&&n.target&&n.target.getElementsByTagName("mat-checkbox")&&n.target.getElementsByTagName("mat-checkbox").length>0?this.multiCheckArray[e]?(this.multiCheckArray[e]=!1,this.tableUtils.deleteInstance(this.multiCheckArrayData,t[this.multiCheckId])):(this.multiCheckArray[e]=!0,this.multiCheckArrayData.push(t[this.multiCheckId])):this.rowClick.emit(t)},t.prototype.getInstaceName=function(t,e){var n="";if(e.objectInstances){for(var o=0;o<e.objectInstances.length;o++)t[e.objectInstances[o]]&&(t=n=t[e.objectInstances[o]]);return this.parseToDecimal(n,e)}return e.date?this.datePipe.transform(t[e.name],"dd/MM/yyyy"):this.parseToDecimal(t[e.name],e)},t.prototype.parseToDecimal=function(t,e){return e.isShares?this.tableUtils.transformToNumber(t,this.sharesNum):e.isCurrency?this.tableUtils.transformToNumber(t,this.decimalNum):t},t.prototype.showSuboperationData=function(t){var e=this;Array.isArray(t)&&t.length>0&&t.forEach((function(t,n){e.suboperationsGeneratedData[n]=e.tableUtils.copyArray(e.suboperationsData),e.checkConditionalOptions(n,t),e.showSuboperationsGeneratedData[n]=e.suboperationsGeneratedData[n].length>0}))},t.prototype.checkConditionalOptions=function(t,e){var n=this;this.suboperationsGeneratedData[t].forEach((function(o,a){if(o.conditional&&o.valueToCompare&&o.itemToCompare)if("string"==typeof o.conditional){if(!n.tableUtils.suboperationConditional(o.conditional,o.valueToCompare,e[o.itemToCompare]))return n.spliceSuboperation(t,a,e)}else o.conditional.forEach((function(i,r){if(!n.tableUtils.suboperationConditional(i,o.valueToCompare[r],e[o.itemToCompare[r]]))return n.spliceSuboperation(t,a,e)}))}))},t.prototype.getButtonCondition=function(t){return!t.buttonConditions||!(!t.buttonConditions.value||!t.buttonConditions.condition||t.buttonConditions.value!==t.buttonConditions.condition)},t.prototype.spliceSuboperation=function(t,e,n){return this.suboperationsGeneratedData[t].splice(e,1),this.checkConditionalOptions(t,n)},t.prototype.isMulticheckDisabled=function(){if(this.disabledMulticheck)return!0;var t=this.multiMinSelected&&"string"==typeof this.multiMinSelected?parseFloat(this.multiMinSelected):this.multiMinSelected;return this.multiCheckArrayData.length<=t},t.prototype.ngOnDestroy=function(){this.dataSourceConnect&&(this.dataSourceConnect.unsubscribe(),this.dataSource.disconnect())},t.decorators=[{type:e.Component,args:[{selector:"ngx-table-generator",template:'<mat-card>\r\n    <div class="table-result">\r\n        <div class="table-header">\r\n            <div class="create-button-container" *ngIf="buttonOptionsData || showMultiCheckButton">\r\n                <ng-container *ngFor="let item of buttonOptionsData">\r\n                    <button class="primary" *ngIf="getButtonCondition(item)" mat-button color="primary" (click)="buttonEvent.emit({event: item.event, data: $event})">\r\n                        <mat-icon>{{ item.icon }}</mat-icon>\r\n                        {{ item.label }}\r\n                    </button>\r\n                </ng-container>\r\n                <button *ngIf="showMultiCheckButton" class="primary" mat-button color="primary" (click)="onMultiCheckAction()" [disabled]="isMulticheckDisabled()">\r\n                    <mat-icon>unarchive</mat-icon>\r\n                    {{ multiCheck.buttonLabel }}\r\n                </button>\r\n            </div>\r\n            <mat-paginator [length]="paginatorOptionData.resultsLength" [pageSize]="paginatorOptionData.limit" showFirstLastButtons (page)="pageEvent($event)"\r\n                class="mat-paginator-sticky" *ngIf="paginatorOptionData"></mat-paginator>\r\n        </div>\r\n        <div class="result-table-wrapper" [ngClass]="{\'result-table-wrapper\':!footerData, \'result-table-wrapper-with-footer\':footerData}">\r\n            <mat-table *ngIf="dataSource" [dataSource]="dataSource" matSort matSortDirection="{{sortOptionData.direction}}" matSortActive="{{sortOptionData.activeSort}}"\r\n                class="classList" (matSortChange)="matSortChange($event)" matSortDisableClear class="result-table mat-elevation-z8">\r\n                <ng-container *ngFor="let item of dataColumns;" matColumnDef="{{item.name}}">\r\n                    <ng-container *ngIf="item.name === \'btnSuboperations\'" matColumnDef="btnSuboperations" sticky>\r\n                        <mat-header-cell *matHeaderCellDef></mat-header-cell>\r\n                        <mat-cell *matCellDef="let item; let i = index">\r\n                            <ng-container *ngIf="showSuboperationsGeneratedData[i]">\r\n                                <button mat-icon-button [matMenuTriggerFor]="menu" (click)="$event.stopPropagation()">\r\n                                    <mat-icon>more_vert</mat-icon>\r\n                                </button>\r\n                                <mat-menu #menu="matMenu">\r\n                                    <button mat-menu-item *ngFor="let sub of suboperationsGeneratedData[i]" (click)="suboperationClicked(sub.label, item)">\r\n                                        <span class="margin-select">{{sub.label}}</span>\r\n                                    </button>\r\n                                </mat-menu>\r\n                            </ng-container>\r\n                            <button mat-icon-button (click)="$event.stopPropagation(); trashOptionAction(item)" *ngIf="trashOption">\r\n                                <mat-icon>delete_forever</mat-icon>\r\n                            </button>\r\n                            <ng-container *ngIf="multiCheck">\r\n                                <mat-checkbox *ngIf="showMulticheck[i]" [checked]="multiCheckArray[i]"></mat-checkbox>\r\n                            </ng-container>\r\n                        </mat-cell>\r\n                    </ng-container>\r\n                    <ng-container>\r\n                        <ng-container *ngIf="item.sort; else NotSorteable">\r\n                            <mat-header-cell mat-sort-header disableClear="true" *matHeaderCellDef>\r\n                                {{item.label}}\r\n                            </mat-header-cell>\r\n                        </ng-container>\r\n                        <ng-template #NotSorteable>\r\n                            <mat-header-cell disableClear="true" *matHeaderCellDef>\r\n                                {{item.label}}\r\n                            </mat-header-cell>\r\n                        </ng-template>\r\n                        <mat-cell [class.number-cell]="item.isCurrency || item.isShares" *matCellDef="let element">\r\n                            <mat-checkbox selected *ngIf="item.isCheckbox; else showLabel" [checked]="element[item.name]"></mat-checkbox>\r\n                            <ng-template #showLabel>\r\n                                <ng-container *ngIf="showWhen && element[item.showWhen]; else showWhen"></ng-container>\r\n                                <ng-template #showWhen>\r\n                                    <ng-container *ngIf="item.objectToCompare; else showInstance">\r\n                                        {{getObjectToCompare(element, item)}}\r\n                                    </ng-container>\r\n                                    <ng-template #showInstance>\r\n                                        {{getInstaceName(element, item) }}\r\n                                    </ng-template>\r\n                                </ng-template>\r\n                            </ng-template>\r\n                        </mat-cell>\r\n                    </ng-container>\r\n                </ng-container>\r\n                <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\r\n                <mat-row *matRowDef="let row; columns: displayedColumns; let index = index; " (click)="onRowClick(row, index, $event)"></mat-row>\r\n            </mat-table>\r\n        </div>\r\n        <div *ngIf="footerData" class="table-footer-data">\r\n            <ng-container *ngFor="let item of footerData;">\r\n                <div class="data-group">\r\n                    <h3>{{item.name}}:</h3>\r\n                    <p>{{item.value | NgxNumberEsPipe:item.decimal}}</p>\r\n                </div>\r\n            </ng-container>\r\n        </div>\r\n    </div>\r\n</mat-card>'}]}],t.ctorParameters=function(){return[{type:r},{type:o.DatePipe}]},t.propDecorators={onPageEvent:[{type:e.Output}],buttonEvent:[{type:e.Output}],rowClick:[{type:e.Output}],sortChange:[{type:e.Output}],suboperationAction:[{type:e.Output}],trashAction:[{type:e.Output}],multiCheckAction:[{type:e.Output}],disabledMulticheck:[{type:e.Input}],footerData:[{type:e.Input}],sort:[{type:e.ViewChild,args:[n.MatSort,{static:!1}]}],paginator:[{type:e.ViewChild,args:[n.MatPaginator,{static:!1}]}],classMap:[{type:e.Input,args:["classMap"]}],dataSourceMap:[{type:e.Input,args:["dataSource"]}],columns:[{type:e.Input,args:["dataColumnsTable"]}],sortOptions:[{type:e.Input,args:["sortOptions"]}],paginatorOption:[{type:e.Input,args:["paginatorOption"]}],buttonOptions:[{type:e.Input,args:["buttonOptions"]}]},t}();var s=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[c],imports:[o.CommonModule,n.MatTableModule,n.MatIconModule,n.MatMenuModule,n.MatButtonModule,n.MatSortModule,n.MatPaginatorModule,n.MatCheckboxModule,n.MatCardModule,n.MatSidenavModule,a.NgxSpanishPipeModule],exports:[c],providers:[r,o.DatePipe]}]}],t}();t.TableGeneratorComponent=c,t.TableGeneratorModule=s,t.TableGeneratorService=i,t.ɵa=r,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-table-generator.umd.min.js.map