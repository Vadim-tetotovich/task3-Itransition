/**
 * @fileoverview added by tsickle
 * Generated from: lib/ngx-table-generator.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ViewChild } from '@angular/core';
import { MatSort, MatPaginator } from '@angular/material';
import { DatePipe } from '@angular/common';
import { TableUtils } from './utils';
export class TableGeneratorComponent {
    /**
     * @param {?} tableUtils
     * @param {?} datePipe
     */
    constructor(tableUtils, datePipe) {
        this.tableUtils = tableUtils;
        this.datePipe = datePipe;
        // tslint:disable-next-line:no-output-on-prefix
        this.onPageEvent = new EventEmitter();
        this.buttonEvent = new EventEmitter();
        this.rowClick = new EventEmitter();
        this.sortChange = new EventEmitter();
        this.suboperationAction = new EventEmitter();
        this.trashAction = new EventEmitter();
        this.multiCheckAction = new EventEmitter();
        this.disabledMulticheck = false;
        this.displayedColumns = [];
        this.sortOptionData = null;
        this.suboperationsData = null;
        this.isSub = false;
        this.buttonOptionsData = null;
        this.paginatorOptionData = null;
        // Button controls
        this.showNewButton = false;
        this.multiCheckArray = [];
        this.multiCheckArrayData = [];
        this.decimalNum = 2;
        this.sharesNum = 0;
        this.suboperationsGeneratedData = [];
        this.showSuboperationsGeneratedData = [];
        this.multiMinSelected = -1;
        this.showMulticheck = [];
    }
    /**
     * @param {?} classMap
     * @return {?}
     */
    set classMap(classMap) {
        classMap.map((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            this.classList += `${item} `;
        }));
    }
    /**
     * @param {?} dataSource
     * @return {?}
     */
    set dataSourceMap(dataSource) {
        this.dataSource = dataSource;
    }
    /**
     * @param {?} columns
     * @return {?}
     */
    set columns(columns) {
        this.isSub = this.isSuboperation(columns);
        this.dataColumns = columns;
        this.displayedColumns = this.generateDisplay(columns);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set sortOptions(value) {
        this.sort = new MatSort();
        this.sortOptionData = {
            activeSort: value.activeSort || this.dataColumns[0].name,
            direction: value.direction || 'asc'
        };
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set paginatorOption(value) {
        this.paginatorOptionData = {
            resultsLength: value.resultsLength || 0,
            limit: value.limit ? value.limit : 20
        };
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set buttonOptions(value) {
        this.buttonOptionsData = value;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    generateDisplay(data) {
        /** @type {?} */
        const array = [];
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            array.push(item.name);
        }));
        return array;
    }
    // tslint:disable-next-line:cognitive-complexity
    /**
     * @param {?} columns
     * @return {?}
     */
    isSuboperation(columns) {
        if (columns && columns[0].name === 'btnSuboperations') {
            if (columns[0].suboperationData) {
                this.suboperationsData = columns[0].suboperationData;
            }
            if (columns[0].trashOption) {
                this.trashOption = true;
            }
            if (columns[0].multiCheck) {
                this.multiCheck = columns[0].multiCheck;
                this.multiCheckId = columns[0].multiCheck.id;
                this.multiNameToCheck = columns[0].multiCheck && columns[0].multiCheck.multiNameToCheck ?
                    columns[0].multiCheck.multiNameToCheck : null;
                this.multiNameValue = columns[0].multiCheck && columns[0].multiCheck.multiNameValue ?
                    columns[0].multiCheck.multiNameValue : null;
                this.multiMinSelected = columns[0].multiCheck && columns[0].multiCheck.multiMinSelected ?
                    columns[0].multiCheck.multiMinSelected : 0;
                this.conditionalMulticheck = columns[0].multiCheck && columns[0].multiCheck.conditionalMulticheck ?
                    columns[0].multiCheck.conditionalMulticheck : 0;
                this.keysMulticheck = columns[0].multiCheck && columns[0].multiCheck.keysMulticheck ?
                    columns[0].multiCheck.keysMulticheck : 0;
                this.valueMulticheckToCompare = columns[0].multiCheck && columns[0].multiCheck.valueMulticheckToCompare ?
                    columns[0].multiCheck.valueMulticheckToCompare : 0;
            }
            return true;
        }
        return false;
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} $event
     * @return {?}
     */
    matSortChange($event) {
        this.sortChange.emit($event);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    pageEvent(event) {
        this.multiCheckArray = [];
        this.onPageEvent.emit(event);
    }
    /**
     * @return {?}
     */
    onMultiCheckAction() {
        this.multiCheckAction.emit(this.multiCheckArrayData);
        this.multiCheckArrayData = [];
        this.multiCheckArray = [];
    }
    /**
     * @param {?} action
     * @param {?} row
     * @return {?}
     */
    suboperationClicked(action, row) {
        /** @type {?} */
        const data = {
            action: action,
            row: row
        };
        this.suboperationAction.emit(data);
    }
    /**
     * @param {?} row
     * @return {?}
     */
    trashOptionAction(row) {
        this.trashAction.emit(row);
    }
    /**
     * @param {?} sort
     * @return {?}
     */
    checkSort(sort) {
        if (sort) {
            return sort;
        }
        else {
            this.sort = new MatSort();
            this.sort.direction = 'asc';
            this.sort.active = this.sortOptionData.activeSort;
            return this.sort;
        }
    }
    /**
     * @param {?} elem
     * @param {?} item
     * @return {?}
     */
    getObjectToCompare(elem, item) {
        for (let i = 0; i < item.objectToCompare.length; i++) {
            if (item.objectToCompare[i].id === elem[item.name]) {
                return this.parseToDecimal(item.objectToCompare[i].label, item);
            }
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.sortChange.emit(this.checkSort(this.sort));
        this.onPageEvent.emit(this.paginator);
        if (this.dataSource.connect) {
            this.dataSourceConnect = this.dataSource.connect().subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (this.suboperationsData) {
                    this.showSuboperationData(data);
                }
                if (data && this.multiCheck) {
                    this.showMultiCheckButton = true;
                    this.multiCheckArray = this.tableUtils.chargeMultiCheckArray(this.dataSource.data, this.multiCheckArrayData, this.multiCheck.id);
                    if (data.length > 0) {
                        this.showMulticheck = this.tableUtils.chargeShowMulticheck(this.conditionalMulticheck, this.keysMulticheck, this.valueMulticheckToCompare, this.dataSource.data);
                    }
                }
            }));
        }
    }
    /**
     * @param {?} row
     * @param {?} index
     * @param {?} event
     * @return {?}
     */
    onRowClick(row, index, event) {
        if (this.multiCheck && event && event.target && event.target.getElementsByTagName('mat-checkbox') &&
            event.target.getElementsByTagName('mat-checkbox').length > 0) {
            if (this.multiCheckArray[index]) {
                this.multiCheckArray[index] = false;
                this.tableUtils.deleteInstance(this.multiCheckArrayData, row[this.multiCheckId]);
            }
            else {
                this.multiCheckArray[index] = true;
                this.multiCheckArrayData.push(row[this.multiCheckId]);
            }
        }
        else {
            this.rowClick.emit(row);
        }
    }
    /**
     * @param {?} elem
     * @param {?} item
     * @return {?}
     */
    getInstaceName(elem, item) {
        /** @type {?} */
        let valueToShow = '';
        if (item.objectInstances) {
            for (let i = 0; i < item.objectInstances.length; i++) {
                if (elem[item.objectInstances[i]]) {
                    valueToShow = elem[item.objectInstances[i]];
                    elem = valueToShow;
                }
            }
            return this.parseToDecimal(valueToShow, item);
        }
        else {
            if (item.date) {
                return this.datePipe.transform(elem[item.name], 'dd/MM/yyyy');
            }
            return this.parseToDecimal(elem[item.name], item);
        }
    }
    /**
     * @param {?} value
     * @param {?} item
     * @return {?}
     */
    parseToDecimal(value, item) {
        if (item.isShares) {
            return this.tableUtils.transformToNumber(value, this.sharesNum);
        }
        if (item.isCurrency) {
            return this.tableUtils.transformToNumber(value, this.decimalNum);
        }
        return value;
    }
    // tslint:disable-next-line:cognitive-complexity
    /**
     * @param {?} data
     * @return {?}
     */
    showSuboperationData(data) {
        if (Array.isArray(data) && data.length > 0) {
            data.forEach((/**
             * @param {?} item
             * @param {?} index
             * @return {?}
             */
            (item, index) => {
                this.suboperationsGeneratedData[index] = this.tableUtils.copyArray(this.suboperationsData);
                this.checkConditionalOptions(index, item);
                this.showSuboperationsGeneratedData[index] = this.suboperationsGeneratedData[index].length > 0 ? true : false;
            }));
        }
    }
    // tslint:disable-next-line:cognitive-complexity
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    checkConditionalOptions(index, item) {
        this.suboperationsGeneratedData[index].forEach((/**
         * @param {?} instance
         * @param {?} i
         * @return {?}
         */
        (instance, i) => {
            if (instance.conditional && instance.valueToCompare && instance.itemToCompare) {
                if (typeof instance.conditional === 'string') {
                    if (!this.tableUtils.suboperationConditional(instance.conditional, instance.valueToCompare, item[instance.itemToCompare])) {
                        return this.spliceSuboperation(index, i, item);
                    }
                }
                else {
                    instance.conditional.forEach((/**
                     * @param {?} elem
                     * @param {?} j
                     * @return {?}
                     */
                    (elem, j) => {
                        if (!this.tableUtils.suboperationConditional(elem, instance.valueToCompare[j], item[instance.itemToCompare[j]])) {
                            return this.spliceSuboperation(index, i, item);
                        }
                    }));
                }
            }
        }));
    }
    /**
     * @param {?} item
     * @return {?}
     */
    getButtonCondition(item) {
        if (item.buttonConditions) {
            if (item.buttonConditions.value && item.buttonConditions.condition
                && item.buttonConditions.value === item.buttonConditions.condition) {
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return true;
        }
    }
    /**
     * @private
     * @param {?} index
     * @param {?} i
     * @param {?} item
     * @return {?}
     */
    spliceSuboperation(index, i, item) {
        this.suboperationsGeneratedData[index].splice(i, 1);
        return this.checkConditionalOptions(index, item);
    }
    /**
     * @return {?}
     */
    isMulticheckDisabled() {
        if (this.disabledMulticheck) {
            return true;
        }
        else {
            /** @type {?} */
            const minSelected = this.multiMinSelected && typeof this.multiMinSelected === 'string'
                ? parseFloat(this.multiMinSelected) : this.multiMinSelected;
            return this.multiCheckArrayData.length <= minSelected;
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.dataSourceConnect) {
            this.dataSourceConnect.unsubscribe();
            this.dataSource.disconnect();
        }
    }
}
TableGeneratorComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: 'ngx-table-generator',
                template: "<mat-card>\r\n    <div class=\"table-result\">\r\n        <div class=\"table-header\">\r\n            <div class=\"create-button-container\" *ngIf=\"buttonOptionsData || showMultiCheckButton\">\r\n                <ng-container *ngFor=\"let item of buttonOptionsData\">\r\n                    <button class=\"primary\" *ngIf=\"getButtonCondition(item)\" mat-button color=\"primary\" (click)=\"buttonEvent.emit({event: item.event, data: $event})\">\r\n                        <mat-icon>{{ item.icon }}</mat-icon>\r\n                        {{ item.label }}\r\n                    </button>\r\n                </ng-container>\r\n                <button *ngIf=\"showMultiCheckButton\" class=\"primary\" mat-button color=\"primary\" (click)=\"onMultiCheckAction()\" [disabled]=\"isMulticheckDisabled()\">\r\n                    <mat-icon>unarchive</mat-icon>\r\n                    {{ multiCheck.buttonLabel }}\r\n                </button>\r\n            </div>\r\n            <mat-paginator [length]=\"paginatorOptionData.resultsLength\" [pageSize]=\"paginatorOptionData.limit\" showFirstLastButtons (page)=\"pageEvent($event)\"\r\n                class=\"mat-paginator-sticky\" *ngIf=\"paginatorOptionData\"></mat-paginator>\r\n        </div>\r\n        <div class=\"result-table-wrapper\" [ngClass]=\"{'result-table-wrapper':!footerData, 'result-table-wrapper-with-footer':footerData}\">\r\n            <mat-table *ngIf=\"dataSource\" [dataSource]=\"dataSource\" matSort matSortDirection=\"{{sortOptionData.direction}}\" matSortActive=\"{{sortOptionData.activeSort}}\"\r\n                class=\"classList\" (matSortChange)=\"matSortChange($event)\" matSortDisableClear class=\"result-table mat-elevation-z8\">\r\n                <ng-container *ngFor=\"let item of dataColumns;\" matColumnDef=\"{{item.name}}\">\r\n                    <ng-container *ngIf=\"item.name === 'btnSuboperations'\" matColumnDef=\"btnSuboperations\" sticky>\r\n                        <mat-header-cell *matHeaderCellDef></mat-header-cell>\r\n                        <mat-cell *matCellDef=\"let item; let i = index\">\r\n                            <ng-container *ngIf=\"showSuboperationsGeneratedData[i]\">\r\n                                <button mat-icon-button [matMenuTriggerFor]=\"menu\" (click)=\"$event.stopPropagation()\">\r\n                                    <mat-icon>more_vert</mat-icon>\r\n                                </button>\r\n                                <mat-menu #menu=\"matMenu\">\r\n                                    <button mat-menu-item *ngFor=\"let sub of suboperationsGeneratedData[i]\" (click)=\"suboperationClicked(sub.label, item)\">\r\n                                        <span class=\"margin-select\">{{sub.label}}</span>\r\n                                    </button>\r\n                                </mat-menu>\r\n                            </ng-container>\r\n                            <button mat-icon-button (click)=\"$event.stopPropagation(); trashOptionAction(item)\" *ngIf=\"trashOption\">\r\n                                <mat-icon>delete_forever</mat-icon>\r\n                            </button>\r\n                            <ng-container *ngIf=\"multiCheck\">\r\n                                <mat-checkbox *ngIf=\"showMulticheck[i]\" [checked]=\"multiCheckArray[i]\"></mat-checkbox>\r\n                            </ng-container>\r\n                        </mat-cell>\r\n                    </ng-container>\r\n                    <ng-container>\r\n                        <ng-container *ngIf=\"item.sort; else NotSorteable\">\r\n                            <mat-header-cell mat-sort-header disableClear=\"true\" *matHeaderCellDef>\r\n                                {{item.label}}\r\n                            </mat-header-cell>\r\n                        </ng-container>\r\n                        <ng-template #NotSorteable>\r\n                            <mat-header-cell disableClear=\"true\" *matHeaderCellDef>\r\n                                {{item.label}}\r\n                            </mat-header-cell>\r\n                        </ng-template>\r\n                        <mat-cell [class.number-cell]=\"item.isCurrency || item.isShares\" *matCellDef=\"let element\">\r\n                            <mat-checkbox selected *ngIf=\"item.isCheckbox; else showLabel\" [checked]=\"element[item.name]\"></mat-checkbox>\r\n                            <ng-template #showLabel>\r\n                                <ng-container *ngIf=\"showWhen && element[item.showWhen]; else showWhen\"></ng-container>\r\n                                <ng-template #showWhen>\r\n                                    <ng-container *ngIf=\"item.objectToCompare; else showInstance\">\r\n                                        {{getObjectToCompare(element, item)}}\r\n                                    </ng-container>\r\n                                    <ng-template #showInstance>\r\n                                        {{getInstaceName(element, item) }}\r\n                                    </ng-template>\r\n                                </ng-template>\r\n                            </ng-template>\r\n                        </mat-cell>\r\n                    </ng-container>\r\n                </ng-container>\r\n                <mat-header-row *matHeaderRowDef=\"displayedColumns; sticky: true\"></mat-header-row>\r\n                <mat-row *matRowDef=\"let row; columns: displayedColumns; let index = index; \" (click)=\"onRowClick(row, index, $event)\"></mat-row>\r\n            </mat-table>\r\n        </div>\r\n        <div *ngIf=\"footerData\" class=\"table-footer-data\">\r\n            <ng-container *ngFor=\"let item of footerData;\">\r\n                <div class=\"data-group\">\r\n                    <h3>{{item.name}}:</h3>\r\n                    <p>{{item.value | NgxNumberEsPipe:item.decimal}}</p>\r\n                </div>\r\n            </ng-container>\r\n        </div>\r\n    </div>\r\n</mat-card>"
            }] }
];
/** @nocollapse */
TableGeneratorComponent.ctorParameters = () => [
    { type: TableUtils },
    { type: DatePipe }
];
TableGeneratorComponent.propDecorators = {
    onPageEvent: [{ type: Output }],
    buttonEvent: [{ type: Output }],
    rowClick: [{ type: Output }],
    sortChange: [{ type: Output }],
    suboperationAction: [{ type: Output }],
    trashAction: [{ type: Output }],
    multiCheckAction: [{ type: Output }],
    disabledMulticheck: [{ type: Input }],
    footerData: [{ type: Input }],
    sort: [{ type: ViewChild, args: [MatSort, { static: false },] }],
    paginator: [{ type: ViewChild, args: [MatPaginator, { static: false },] }],
    classMap: [{ type: Input, args: ['classMap',] }],
    dataSourceMap: [{ type: Input, args: ['dataSource',] }],
    columns: [{ type: Input, args: ['dataColumnsTable',] }],
    sortOptions: [{ type: Input, args: ['sortOptions',] }],
    paginatorOption: [{ type: Input, args: ['paginatorOption',] }],
    buttonOptions: [{ type: Input, args: ['buttonOptions',] }]
};
if (false) {
    /** @type {?} */
    TableGeneratorComponent.prototype.onPageEvent;
    /** @type {?} */
    TableGeneratorComponent.prototype.buttonEvent;
    /** @type {?} */
    TableGeneratorComponent.prototype.rowClick;
    /** @type {?} */
    TableGeneratorComponent.prototype.sortChange;
    /** @type {?} */
    TableGeneratorComponent.prototype.suboperationAction;
    /** @type {?} */
    TableGeneratorComponent.prototype.trashAction;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiCheckAction;
    /** @type {?} */
    TableGeneratorComponent.prototype.disabledMulticheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.footerData;
    /** @type {?} */
    TableGeneratorComponent.prototype.sort;
    /** @type {?} */
    TableGeneratorComponent.prototype.paginator;
    /**
     * @type {?}
     * @private
     */
    TableGeneratorComponent.prototype.classList;
    /** @type {?} */
    TableGeneratorComponent.prototype.dataColumns;
    /** @type {?} */
    TableGeneratorComponent.prototype.displayedColumns;
    /** @type {?} */
    TableGeneratorComponent.prototype.dataSource;
    /** @type {?} */
    TableGeneratorComponent.prototype.sortOptionData;
    /**
     * @type {?}
     * @private
     */
    TableGeneratorComponent.prototype.suboperationsData;
    /**
     * @type {?}
     * @private
     */
    TableGeneratorComponent.prototype.isSub;
    /** @type {?} */
    TableGeneratorComponent.prototype.buttonOptionsData;
    /** @type {?} */
    TableGeneratorComponent.prototype.paginatorOptionData;
    /** @type {?} */
    TableGeneratorComponent.prototype.trashOption;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiCheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.showNewButton;
    /** @type {?} */
    TableGeneratorComponent.prototype.showMultiCheckButton;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiCheckArray;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiCheckArrayData;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiCheckId;
    /** @type {?} */
    TableGeneratorComponent.prototype.dataSourceConnect;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiNameToCheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiNameValue;
    /** @type {?} */
    TableGeneratorComponent.prototype.decimalNum;
    /** @type {?} */
    TableGeneratorComponent.prototype.sharesNum;
    /** @type {?} */
    TableGeneratorComponent.prototype.suboperationsGeneratedData;
    /** @type {?} */
    TableGeneratorComponent.prototype.showSuboperationsGeneratedData;
    /** @type {?} */
    TableGeneratorComponent.prototype.multiMinSelected;
    /** @type {?} */
    TableGeneratorComponent.prototype.showMulticheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.conditionalMulticheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.keysMulticheck;
    /** @type {?} */
    TableGeneratorComponent.prototype.valueMulticheckToCompare;
    /** @type {?} */
    TableGeneratorComponent.prototype.tableUtils;
    /** @type {?} */
    TableGeneratorComponent.prototype.datePipe;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXRhYmxlLWdlbmVyYXRvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtdGFibGUtZ2VuZXJhdG9yLyIsInNvdXJjZXMiOlsibGliL25neC10YWJsZS1nZW5lcmF0b3IuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQ3BILE9BQU8sRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFMUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFhckMsTUFBTSxPQUFPLHVCQUF1Qjs7Ozs7SUE4Q2hDLFlBQ1csVUFBc0IsRUFDdEIsUUFBa0I7UUFEbEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixhQUFRLEdBQVIsUUFBUSxDQUFVOztRQTlDbkIsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3RDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN0QyxhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNuQyxlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNyQyx1QkFBa0IsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQzdDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN0QyxxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTVDLHVCQUFrQixHQUFHLEtBQUssQ0FBQztRQVE3QixxQkFBZ0IsR0FBYSxFQUFFLENBQUM7UUFFaEMsbUJBQWMsR0FBZ0IsSUFBSSxDQUFDO1FBQ2xDLHNCQUFpQixHQUFRLElBQUksQ0FBQztRQUM5QixVQUFLLEdBQUcsS0FBSyxDQUFD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Qjs7SUFDNUIsb0RBQXVDOztJQUN2QyxtREFBd0I7O0lBQ3hCLGlEQUFzQjs7SUFDdEIsNkNBQXNCOztJQUN0Qiw0Q0FBcUI7O0lBQ3JCLDZEQUF1Qzs7SUFDdkMsaUVBQTJDOztJQUMzQyxtREFBa0M7O0lBQ2xDLGlEQUEyQjs7SUFDM0Isd0RBQTZCOztJQUM3QixpREFBc0I7O0lBQ3RCLDJEQUFnQzs7SUFHNUIsNkNBQTZCOztJQUM3QiwyQ0FBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBWaWV3Q2hpbGQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTWF0U29ydCwgTWF0UGFnaW5hdG9yIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBEYXRlUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBUYWJsZVV0aWxzIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBJVGFibGVDb2x1bW4gfSBmcm9tICcuL2ludGVyZmFjZXMvSVRhYmxlQ29sdW1uJztcbmltcG9ydCB7IElTb3J0T3B0aW9uIH0gZnJvbSAnLi9pbnRlcmZhY2VzL0lTb3J0T3B0aW9ucyc7XG5pbXBvcnQgeyBJUGFnaW5hdG9yT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlcy9JUGFnaW5hdG9yT3B0aW9ucyc7XG5pbXBvcnQgeyBJRm9vdGVyRGF0YSB9IGZyb20gJy4vaW50ZXJmYWNlcy9JRm9vdGVyRGF0YSc7XG5pbXBvcnQgeyBJQnV0dG9uT3B0aW9ucyB9IGZyb20gJy4vaW50ZXJmYWNlcy9JQnV0dG9uT3B0aW9ucyc7XG5cbkBDb21wb25lbnQoe1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICBzZWxlY3RvcjogJ25neC10YWJsZS1nZW5lcmF0b3InLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9uZ3gtdGFibGUtZ2VuZXJhdG9yLmNvbXBvbmVudC5odG1sJyxcbn0pXG5cbmV4cG9ydCBjbGFzcyBUYWJsZUdlbmVyYXRvckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICAgIEBPdXRwdXQoKSBvblBhZ2VFdmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBidXR0b25FdmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSByb3dDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBzb3J0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICAgQE91dHB1dCgpIHN1Ym9wZXJhdGlvbkFjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSB0cmFzaEFjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBtdWx0aUNoZWNrQWN0aW9uID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBASW5wdXQoKSBkaXNhYmxlZE11bHRpY2hlY2sgPSBmYWxzZTtcbiAgICBASW5wdXQoKSBmb290ZXJEYXRhOiBJRm9vdGVyRGF0YTsgLy8gW3tuYW1lOiAnc3RyaW5nJywgdmFsdWU6ICdzdHJpbmcnfV07XG5cbiAgICBAVmlld0NoaWxkKE1hdFNvcnQsIHtzdGF0aWM6IGZhbHNlfSkgc29ydDogTWF0U29ydDtcbiAgICBAVmlld0NoaWxkKE1hdFBhZ2luYXRvciwge3N0YXRpYzogZmFsc2V9KSBwYWdpbmF0b3I6IE1hdFBhZ2luYXRvcjtcblxuICAgIHByaXZhdGUgY2xhc3NMaXN0OiBzdHJpbmc7XG4gICAgcHVibGljIGRhdGFDb2x1bW5zOiBJVGFibGVDb2x1bW5bXTtcbiAgICBwdWJsaWMgZGlzcGxheWVkQ29sdW1uczogc3RyaW5nW10gPSBbXTtcbiAgICBwdWJsaWMgZGF0YVNvdXJjZTogYW55O1xuICAgIHB1YmxpYyBzb3J0T3B0aW9uRGF0YTogSVNvcnRPcHRpb24gPSBudWxsO1xuICAgIHByaXZhdGUgc3Vib3BlcmF0aW9uc0RhdGE6IGFueSA9IG51bGw7XG4gICAgcHJpdmF0ZSBpc1N1YiA9IGZhbHNlO1xuICAgIHB1YmxpYyBidXR0b25PcHRpb25zRGF0YTogSUJ1dHRvbk9wdGlvbnNbXSA9IG51bGw7XG4gICAgcHVibGljIHBhZ2luYXRvck9wdGlvbkRhdGE6IElQYWdpbmF0b3JPcHRpb25zID0gbnVsbDtcbiAgICBwdWJsaWMgdHJhc2hPcHRpb247XG4gICAgcHVibGljIG11bHRpQ2hlY2s7XG4gICAgLy8gQnV0dG9uIGNvbnRyb2xzXG4gICAgcHVibGljIHNob3dOZXdCdXR0b24gPSBmYWxzZTtcbiAgICBwdWJsaWMgc2hvd011bHRpQ2hlY2tCdXR0b246IGJvb2xlYW47XG4gICAgcHVibGljIG11bHRpQ2hlY2tBcnJheSA9IFtdO1xuICAgIHB1YmxpYyBtdWx0aUNoZWNrQXJyYXlEYXRhID0gW107XG4gICAgcHVibGljIG11bHRpQ2hlY2tJZDogc3RyaW5nO1xuICAgIHB1YmxpYyBkYXRhU291cmNlQ29ubmVjdDogU3Vic2NyaXB0aW9uO1xuICAgIHB1YmxpYyBtdWx0aU5hbWVUb0NoZWNrO1xuICAgIHB1YmxpYyBtdWx0aU5hbWVWYWx1ZTtcbiAgICBwdWJsaWMgZGVjaW1hbE51bSA9IDI7XG4gICAgcHVibGljIHNoYXJlc051bSA9IDA7XG4gICAgcHVibGljIHN1Ym9wZXJhdGlvbnNHZW5lcmF0ZWREYXRhID0gW107XG4gICAgcHVibGljIHNob3dTdWJvcGVyYXRpb25zR2VuZXJhdGVkRGF0YSA9IFtdO1xuICAgIHB1YmxpYyBtdWx0aU1pblNlbGVjdGVkOiBhbnkgPSAtMTtcbiAgICBwdWJsaWMgc2hvd011bHRpY2hlY2sgPSBbXTtcbiAgICBwdWJsaWMgY29uZGl0aW9uYWxNdWx0aWNoZWNrO1xuICAgIHB1YmxpYyBrZXlzTXVsdGljaGVjaztcbiAgICBwdWJsaWMgdmFsdWVNdWx0aWNoZWNrVG9Db21wYXJlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyB0YWJsZVV0aWxzOiBUYWJsZVV0aWxzLFxuICAgICAgICBwdWJsaWMgZGF0ZVBpcGU6IERhdGVQaXBlKSB7XG4gICAgfVxuXG4gICAgQElucHV0KCdjbGFzc01hcCcpXG4gICAgcHVibGljIHNldCBjbGFzc01hcChjbGFzc01hcDogYW55KSB7XG4gICAgICAgIGNsYXNzTWFwLm1hcCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsYXNzTGlzdCArPSBgJHtpdGVtfSBgO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBASW5wdXQoJ2RhdGFTb3VyY2UnKVxuICAgIHB1YmxpYyBzZXQgZGF0YVNvdXJjZU1hcChkYXRhU291cmNlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICB9XG5cbiAgICBASW5wdXQoJ2RhdGFDb2x1bW5zVGFibGUnKVxuICAgIHB1YmxpYyBzZXQgY29sdW1ucyhjb2x1bW5zOiBJVGFibGVDb2x1bW5bXSkge1xuICAgICAgICB0aGlzLmlzU3ViID0gdGhpcy5pc1N1Ym9wZXJhdGlvbihjb2x1bW5zKTtcbiAgICAgICAgdGhpcy5kYXRhQ29sdW1ucyA9IGNvbHVtbnM7XG4gICAgICAgIHRoaXMuZGlzcGxheWVkQ29sdW1ucyA9IHRoaXMuZ2VuZXJhdGVEaXNwbGF5KGNvbHVtbnMpO1xuICAgIH1cblxuICAgIEBJbnB1dCgnc29ydE9wdGlvbnMnKVxuICAgIHB1YmxpYyBzZXQgc29ydE9wdGlvbnModmFsdWU6IElTb3J0T3B0aW9uKSB7XG4gICAgICAgIHRoaXMuc29ydCA9IG5ldyBNYXRTb3J0KCk7XG4gICAgICAgIHRoaXMuc29ydE9wdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICBhY3RpdmVTb3J0OiB2YWx1ZS5hY3RpdmVTb3J0IHx8IHRoaXMuZGF0YUNvbHVtbnNbMF0ubmFtZSxcbiAgICAgICAgICAgIGRpcmVjdGlvbjogdmFsdWUuZGlyZWN0aW9uIHx8ICdhc2MnXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQElucHV0KCdwYWdpbmF0b3JPcHRpb24nKVxuICAgIHB1YmxpYyBzZXQgcGFnaW5hdG9yT3B0aW9uKHZhbHVlOiBJUGFnaW5hdG9yT3B0aW9ucykge1xuICAgICAgICB0aGlzLnBhZ2luYXRvck9wdGlvbkRhdGEgPSB7XG4gICAgICAgICAgICByZXN1bHRzTGVuZ3RoOiB2YWx1ZS5yZXN1bHRzTGVuZ3RoIHx8IDAsXG4gICAgICAgICAgICBsaW1pdDogdmFsdWUubGltaXQgPyB2YWx1ZS5saW1pdCA6IDIwXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQElucHV0KCdidXR0b25PcHRpb25zJylcbiAgICBwdWJsaWMgc2V0IGJ1dHRvbk9wdGlvbnModmFsdWU6IElCdXR0b25PcHRpb25zW10pIHtcbiAgICAgICAgdGhpcy5idXR0b25PcHRpb25zRGF0YSA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdlbmVyYXRlRGlzcGxheShkYXRhOiBJVGFibGVDb2x1bW5bXSkge1xuICAgICAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgICAgICBkYXRhLmZvckVhY2goKGl0ZW06IHsgbmFtZTogc3RyaW5nOyB9KSA9PiB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKGl0ZW0ubmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb2duaXRpdmUtY29tcGxleGl0eVxuICAgIGlzU3Vib3BlcmF0aW9uKGNvbHVtbnMpIHtcbiAgICAgICAgaWYgKGNvbHVtbnMgJiYgY29sdW1uc1swXS5uYW1lID09PSAnYnRuU3Vib3BlcmF0aW9ucycpIHtcbiAgICAgICAgICAgIGlmIChjb2x1bW5zWzBdLnN1Ym9wZXJhdGlvbkRhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Ym9wZXJhdGlvbnNEYXRhID0gY29sdW1uc1swXS5zdWJvcGVyYXRpb25EYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbHVtbnNbMF0udHJhc2hPcHRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYXNoT3B0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2x1bW5zWzBdLm11bHRpQ2hlY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLm11bHRpQ2hlY2sgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2s7XG4gICAgICAgICAgICAgICAgdGhpcy5tdWx0aUNoZWNrSWQgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2suaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5tdWx0aU5hbWVUb0NoZWNrID0gY29sdW1uc1swXS5tdWx0aUNoZWNrICYmIGNvbHVtbnNbMF0ubXVsdGlDaGVjay5tdWx0aU5hbWVUb0NoZWNrID9cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uc1swXS5tdWx0aUNoZWNrLm11bHRpTmFtZVRvQ2hlY2sgOiBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMubXVsdGlOYW1lVmFsdWUgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2sgJiYgY29sdW1uc1swXS5tdWx0aUNoZWNrLm11bHRpTmFtZVZhbHVlID9cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uc1swXS5tdWx0aUNoZWNrLm11bHRpTmFtZVZhbHVlIDogbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLm11bHRpTWluU2VsZWN0ZWQgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2sgJiYgY29sdW1uc1swXS5tdWx0aUNoZWNrLm11bHRpTWluU2VsZWN0ZWQgP1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zWzBdLm11bHRpQ2hlY2subXVsdGlNaW5TZWxlY3RlZCA6IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25kaXRpb25hbE11bHRpY2hlY2sgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2sgJiYgY29sdW1uc1swXS5tdWx0aUNoZWNrLmNvbmRpdGlvbmFsTXVsdGljaGVjayA/XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnNbMF0ubXVsdGlDaGVjay5jb25kaXRpb25hbE11bHRpY2hlY2sgOiAwO1xuICAgICAgICAgICAgICAgIHRoaXMua2V5c011bHRpY2hlY2sgPSBjb2x1bW5zWzBdLm11bHRpQ2hlY2sgJiYgY29sdW1uc1swXS5tdWx0aUNoZWNrLmtleXNNdWx0aWNoZWNrID9cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uc1swXS5tdWx0aUNoZWNrLmtleXNNdWx0aWNoZWNrIDogMDtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlTXVsdGljaGVja1RvQ29tcGFyZSA9IGNvbHVtbnNbMF0ubXVsdGlDaGVjayAmJiBjb2x1bW5zWzBdLm11bHRpQ2hlY2sudmFsdWVNdWx0aWNoZWNrVG9Db21wYXJlID9cbiAgICAgICAgICAgICAgICAgICAgY29sdW1uc1swXS5tdWx0aUNoZWNrLnZhbHVlTXVsdGljaGVja1RvQ29tcGFyZSA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7IH1cblxuICAgIG1hdFNvcnRDaGFuZ2UoJGV2ZW50KSB7XG4gICAgICAgIHRoaXMuc29ydENoYW5nZS5lbWl0KCRldmVudCk7XG4gICAgfVxuXG4gICAgcGFnZUV2ZW50KGV2ZW50KSB7XG4gICAgICAgIHRoaXMubXVsdGlDaGVja0FycmF5ID0gW107XG4gICAgICAgIHRoaXMub25QYWdlRXZlbnQuZW1pdChldmVudCk7XG4gICAgfVxuXG4gICAgb25NdWx0aUNoZWNrQWN0aW9uKCkge1xuICAgICAgICB0aGlzLm11bHRpQ2hlY2tBY3Rpb24uZW1pdCh0aGlzLm11bHRpQ2hlY2tBcnJheURhdGEpO1xuICAgICAgICB0aGlzLm11bHRpQ2hlY2tBcnJheURhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5tdWx0aUNoZWNrQXJyYXkgPSBbXTtcbiAgICB9XG5cbiAgICBzdWJvcGVyYXRpb25DbGlja2VkKGFjdGlvbiwgcm93KSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgIHJvdzogcm93XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3Vib3BlcmF0aW9uQWN0aW9uLmVtaXQoZGF0YSk7XG4gICAgfVxuXG4gICAgdHJhc2hPcHRpb25BY3Rpb24ocm93KSB7XG4gICAgICAgIHRoaXMudHJhc2hBY3Rpb24uZW1pdChyb3cpO1xuICAgIH1cbiAgICBjaGVja1NvcnQoc29ydCkge1xuICAgICAgICBpZiAoc29ydCkge1xuICAgICAgICAgICAgcmV0dXJuIHNvcnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNvcnQgPSBuZXcgTWF0U29ydCgpO1xuICAgICAgICAgICAgdGhpcy5zb3J0LmRpcmVjdGlvbiA9ICdhc2MnO1xuICAgICAgICAgICAgdGhpcy5zb3J0LmFjdGl2ZSA9IHRoaXMuc29ydE9wdGlvbkRhdGEuYWN0aXZlU29ydDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T2JqZWN0VG9Db21wYXJlKGVsZW0sIGl0ZW0pIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtLm9iamVjdFRvQ29tcGFyZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGl0ZW0ub2JqZWN0VG9Db21wYXJlW2ldLmlkID09PSBlbGVtW2l0ZW0ubmFtZV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVRvRGVjaW1hbChpdGVtLm9iamVjdFRvQ29tcGFyZVtpXS5sYWJlbCwgaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLnNvcnRDaGFuZ2UuZW1pdCh0aGlzLmNoZWNrU29ydCh0aGlzLnNvcnQpKTtcbiAgICAgICAgdGhpcy5vblBhZ2VFdmVudC5lbWl0KHRoaXMucGFnaW5hdG9yKTtcbiAgICAgICAgaWYgKHRoaXMuZGF0YVNvdXJjZS5jb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2VDb25uZWN0ID0gdGhpcy5kYXRhU291cmNlLmNvbm5lY3QoKS5zdWJzY3JpYmUoKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdWJvcGVyYXRpb25zRGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dTdWJvcGVyYXRpb25EYXRhKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiB0aGlzLm11bHRpQ2hlY2spIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TXVsdGlDaGVja0J1dHRvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubXVsdGlDaGVja0FycmF5ID0gdGhpcy50YWJsZVV0aWxzLmNoYXJnZU11bHRpQ2hlY2tBcnJheSh0aGlzLmRhdGFTb3VyY2UuZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXVsdGlDaGVja0FycmF5RGF0YSwgdGhpcy5tdWx0aUNoZWNrLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TXVsdGljaGVjayA9IHRoaXMudGFibGVVdGlscy5jaGFyZ2VTaG93TXVsdGljaGVjayh0aGlzLmNvbmRpdGlvbmFsTXVsdGljaGVjayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtleXNNdWx0aWNoZWNrLCB0aGlzLnZhbHVlTXVsdGljaGVja1RvQ29tcGFyZSwgdGhpcy5kYXRhU291cmNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIG9uUm93Q2xpY2socm93LCBpbmRleCwgZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMubXVsdGlDaGVjayAmJiBldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtYXQtY2hlY2tib3gnKSAmJlxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtYXQtY2hlY2tib3gnKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aUNoZWNrQXJyYXlbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tdWx0aUNoZWNrQXJyYXlbaW5kZXhdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy50YWJsZVV0aWxzLmRlbGV0ZUluc3RhbmNlKHRoaXMubXVsdGlDaGVja0FycmF5RGF0YSwgcm93W3RoaXMubXVsdGlDaGVja0lkXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubXVsdGlDaGVja0FycmF5W2luZGV4XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5tdWx0aUNoZWNrQXJyYXlEYXRhLnB1c2gocm93W3RoaXMubXVsdGlDaGVja0lkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJvd0NsaWNrLmVtaXQocm93KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEluc3RhY2VOYW1lKGVsZW0sIGl0ZW0pIHtcbiAgICAgICAgbGV0IHZhbHVlVG9TaG93ID0gJyc7XG4gICAgICAgIGlmIChpdGVtLm9iamVjdEluc3RhbmNlcykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtLm9iamVjdEluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtW2l0ZW0ub2JqZWN0SW5zdGFuY2VzW2ldXSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZVRvU2hvdyA9IGVsZW1baXRlbS5vYmplY3RJbnN0YW5jZXNbaV1dO1xuICAgICAgICAgICAgICAgICAgICBlbGVtID0gdmFsdWVUb1Nob3c7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VUb0RlY2ltYWwodmFsdWVUb1Nob3csIGl0ZW0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGl0ZW0uZGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGVQaXBlLnRyYW5zZm9ybShlbGVtW2l0ZW0ubmFtZV0sICdkZC9NTS95eXl5Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlVG9EZWNpbWFsKGVsZW1baXRlbS5uYW1lXSwgaXRlbSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwYXJzZVRvRGVjaW1hbCh2YWx1ZSwgaXRlbSkge1xuICAgICAgICBpZiAoaXRlbS5pc1NoYXJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFibGVVdGlscy50cmFuc2Zvcm1Ub051bWJlcih2YWx1ZSwgdGhpcy5zaGFyZXNOdW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmlzQ3VycmVuY3kpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYmxlVXRpbHMudHJhbnNmb3JtVG9OdW1iZXIodmFsdWUsIHRoaXMuZGVjaW1hbE51bSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb2duaXRpdmUtY29tcGxleGl0eVxuICAgIHB1YmxpYyBzaG93U3Vib3BlcmF0aW9uRGF0YShkYXRhKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpICYmIGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vib3BlcmF0aW9uc0dlbmVyYXRlZERhdGFbaW5kZXhdID0gdGhpcy50YWJsZVV0aWxzLmNvcHlBcnJheSh0aGlzLnN1Ym9wZXJhdGlvbnNEYXRhKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrQ29uZGl0aW9uYWxPcHRpb25zKGluZGV4LCBpdGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dTdWJvcGVyYXRpb25zR2VuZXJhdGVkRGF0YVtpbmRleF0gPSB0aGlzLnN1Ym9wZXJhdGlvbnNHZW5lcmF0ZWREYXRhW2luZGV4XS5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29nbml0aXZlLWNvbXBsZXhpdHlcbiAgICBwdWJsaWMgY2hlY2tDb25kaXRpb25hbE9wdGlvbnMoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgdGhpcy5zdWJvcGVyYXRpb25zR2VuZXJhdGVkRGF0YVtpbmRleF0uZm9yRWFjaCgoaW5zdGFuY2UsIGkpID0+IHtcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5jb25kaXRpb25hbCAmJiBpbnN0YW5jZS52YWx1ZVRvQ29tcGFyZSAmJiBpbnN0YW5jZS5pdGVtVG9Db21wYXJlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnN0YW5jZS5jb25kaXRpb25hbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRhYmxlVXRpbHMuc3Vib3BlcmF0aW9uQ29uZGl0aW9uYWwoaW5zdGFuY2UuY29uZGl0aW9uYWwsIGluc3RhbmNlLnZhbHVlVG9Db21wYXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVtpbnN0YW5jZS5pdGVtVG9Db21wYXJlXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNwbGljZVN1Ym9wZXJhdGlvbihpbmRleCwgaSwgaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5jb25kaXRpb25hbC5mb3JFYWNoKChlbGVtLCBqKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudGFibGVVdGlscy5zdWJvcGVyYXRpb25Db25kaXRpb25hbChlbGVtLCBpbnN0YW5jZS52YWx1ZVRvQ29tcGFyZVtqXSwgaXRlbVtpbnN0YW5jZS5pdGVtVG9Db21wYXJlW2pdXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zcGxpY2VTdWJvcGVyYXRpb24oaW5kZXgsIGksIGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRCdXR0b25Db25kaXRpb24oaXRlbSkge1xuICAgICAgICBpZiAoaXRlbS5idXR0b25Db25kaXRpb25zKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5idXR0b25Db25kaXRpb25zLnZhbHVlICYmIGl0ZW0uYnV0dG9uQ29uZGl0aW9ucy5jb25kaXRpb25cbiAgICAgICAgICAgICAgICAmJiBpdGVtLmJ1dHRvbkNvbmRpdGlvbnMudmFsdWUgPT09IGl0ZW0uYnV0dG9uQ29uZGl0aW9ucy5jb25kaXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNwbGljZVN1Ym9wZXJhdGlvbihpbmRleDogYW55LCBpOiBudW1iZXIsIGl0ZW06IGFueSkge1xuICAgICAgICB0aGlzLnN1Ym9wZXJhdGlvbnNHZW5lcmF0ZWREYXRhW2luZGV4XS5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrQ29uZGl0aW9uYWxPcHRpb25zKGluZGV4LCBpdGVtKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgaXNNdWx0aWNoZWNrRGlzYWJsZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkTXVsdGljaGVjaykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBtaW5TZWxlY3RlZCA9IHRoaXMubXVsdGlNaW5TZWxlY3RlZCAmJiB0eXBlb2YgdGhpcy5tdWx0aU1pblNlbGVjdGVkID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgID8gcGFyc2VGbG9hdCh0aGlzLm11bHRpTWluU2VsZWN0ZWQpIDogdGhpcy5tdWx0aU1pblNlbGVjdGVkO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlDaGVja0FycmF5RGF0YS5sZW5ndGggPD0gbWluU2VsZWN0ZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2VDb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2VDb25uZWN0LnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19