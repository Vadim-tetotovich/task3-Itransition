/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
export class TableUtils {
    /**
     * @param {?} array
     * @param {?} value
     * @return {?}
     */
    deleteInstance(array, value) {
        for (let i = 0; i < array.length; i++) {
            if (value === array[i]) {
                array.splice(i, 1);
                break;
            }
        }
        return array;
    }
    /**
     * @param {?} data
     * @param {?} arrayData
     * @param {?} id
     * @return {?}
     */
    chargeMultiCheckArray(data, arrayData, id) {
        /** @type {?} */
        const array = [];
        for (let i = 0; i < data.length; i++) {
            arrayData.map((/**
             * @param {?} item
             * @return {?}
             */
            (item) => {
                if (item === data[i][id]) {
                    array[i] = true;
                }
            }));
        }
        return array;
    }
    /**
     * @param {?} val
     * @param {?} decimals
     * @return {?}
     */
    transformToNumber(val, decimals) {
        if (val !== undefined && val !== null) {
            decimals = decimals || decimals === 0 ? decimals : 2;
            if (isNaN(val)) {
                return val;
            }
            else {
                val = val.toLocaleString('es-ES', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
                if (val.includes(',')) {
                    val = this.covertMillarWithDecimalToSpanish(val);
                }
                else {
                    val = this.convertMillarToSpanish(val);
                }
                return val;
            }
        }
        else {
            return '';
        }
    }
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    convertMillarToSpanish(val) {
        /** @type {?} */
        const splitVal = val.split('');
        if (splitVal.length === 4) {
            splitVal.splice(1, 0, '.');
        }
        val = '';
        splitVal.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            val += element;
        }));
        return val;
    }
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    covertMillarWithDecimalToSpanish(val) {
        /** @type {?} */
        const splitVal = val.split(',');
        if (splitVal[0].length === 4) {
            /** @type {?} */
            let naturalNum = splitVal[0];
            splitVal[0] = '';
            naturalNum = naturalNum.split('');
            naturalNum.splice(1, 0, '.');
            naturalNum.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                splitVal[0] += element;
            }));
            val = `${splitVal[0]},${splitVal[1]}`;
        }
        return val;
    }
    /**
     * @param {?} item
     * @return {?}
     */
    copyArray(item) {
        /** @type {?} */
        let result = null;
        if (!item) {
            return result;
        }
        if (Array.isArray(item)) {
            result = [];
            item.forEach((/**
             * @param {?} element
             * @return {?}
             */
            (element) => {
                result.push(this.copyArray(element));
            }));
        }
        else if (item instanceof Object && !(item instanceof Function)) {
            result = {};
            for (const key in item) {
                if (key) {
                    result[key] = this.copyArray(item[key]);
                }
            }
        }
        return result || item;
    }
    /**
     * @param {?} conditionalMulticheck
     * @param {?} keysMulticheck
     * @param {?} valueMulticheckToCompare
     * @param {?} data
     * @return {?}
     */
    chargeShowMulticheck(conditionalMulticheck, keysMulticheck, valueMulticheckToCompare, data) {
        /** @type {?} */
        const showArray = [];
        data.forEach((/**
         * @param {?} element
         * @param {?} index
         * @return {?}
         */
        (element, index) => {
            showArray[index] = true;
        }));
        if (conditionalMulticheck && keysMulticheck && valueMulticheckToCompare) {
            for (let i = 0; i < keysMulticheck.length; i++) {
                data.forEach((/**
                 * @param {?} element
                 * @param {?} index
                 * @return {?}
                 */
                (element, index) => {
                    if (!this.suboperationConditional(conditionalMulticheck[i], valueMulticheckToCompare[i], element[keysMulticheck[i]])
                        && showArray[index]) {
                        showArray[index] = false;
                    }
                }));
            }
        }
        return showArray;
    }
    /**
     * @param {?} conditional
     * @param {?} valueToCompare
     * @param {?} value
     * @return {?}
     */
    suboperationConditional(conditional, valueToCompare, value) {
        switch (conditional) {
            case '<':
                return parseFloat(value) < parseFloat(valueToCompare);
            case '>':
                return parseFloat(value) > parseFloat(valueToCompare);
            case '===':
                return (value || value === 0 || value === false ? value.toString() : value) ===
                    (valueToCompare || valueToCompare === 0 || valueToCompare === false ? valueToCompare.toString() : valueToCompare);
            case '>=':
                return value >= valueToCompare;
            case '<=':
                return value <= valueToCompare;
            case '<day':
                return (new Date(value).setHours(0) - new Date().setHours(0, 0, 0, 0)) < 0;
            case '>day':
                return (new Date(value).setHours(0) - new Date().setHours(0, 0, 0, 0)) > 0;
        }
    }
}
TableUtils.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */ TableUtils.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function TableUtils_Factory() { return new TableUtils(); }, token: TableUtils, providedIn: "root" });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtdGFibGUtZ2VuZXJhdG9yLyIsInNvdXJjZXMiOlsibGliL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7QUFLM0MsTUFBTSxPQUFPLFVBQVU7Ozs7OztJQUNaLGNBQWMsQ0FBQyxLQUFLLEVBQUUsS0FBSztRQUM5QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNuQyxJQUFJLEtBQUssS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3BCLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNuQixNQUFNO2FBQ1Q7U0FDSjtRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7Ozs7Ozs7SUFFTSxxQkFBcUIsQ0FBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLEVBQUU7O2NBQ3RDLEtBQUssR0FBRyxFQUFFO1FBQ2hCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ2xDLFNBQVMsQ0FBQyxHQUFHOzs7O1lBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDbkIsSUFBSSxJQUFJLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFO29CQUN0QixLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO2lCQUNuQjtZQUNMLENBQUMsRUFBQyxDQUFDO1NBQ047UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDOzs7Ozs7SUFFTSxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsUUFBUTtRQUNsQyxJQUFJLEdBQUcsS0FBSyxTQUFTLElBQUksR0FBRyxLQUFL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LFVBQVUsU0FBQztnQkFDUixVQUFVLEVBQUUsTUFBTTthQUNyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICAgIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgVGFibGVVdGlscyB7XHJcbiAgICBwdWJsaWMgZGVsZXRlSW5zdGFuY2UoYXJyYXksIHZhbHVlKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IGFycmF5W2ldKSB7XHJcbiAgICAgICAgICAgICAgICBhcnJheS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyYXk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNoYXJnZU11bHRpQ2hlY2tBcnJheShkYXRhLCBhcnJheURhdGEsIGlkKSB7XHJcbiAgICAgICAgY29uc3QgYXJyYXkgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYXJyYXlEYXRhLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT09IGRhdGFbaV1baWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlbaV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0cmFuc2Zvcm1Ub051bWJlcih2YWwsIGRlY2ltYWxzKSB7XHJcbiAgICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkICYmIHZhbCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkZWNpbWFscyA9IGRlY2ltYWxzIHx8IGRlY2ltYWxzID09PSAwID8gZGVjaW1hbHMgOiAyO1xyXG4gICAgICAgICAgICBpZiAoaXNOYU4odmFsKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbCA9IHZhbC50b0xvY2FsZVN0cmluZygnZXMtRVMnLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMsIG1heGltdW1GcmFjdGlvbkRpZ2l0czogZGVjaW1hbHMgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsLmluY2x1ZGVzKCcsJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLmNvdmVydE1pbGxhcldpdGhEZWNpbWFsVG9TcGFuaXNoKHZhbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHRoaXMuY29udmVydE1pbGxhclRvU3BhbmlzaCh2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb252ZXJ0TWlsbGFyVG9TcGFuaXNoKHZhbDogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc3BsaXRWYWwgPSB2YWwuc3BsaXQoJycpO1xyXG4gICAgICAgIGlmIChzcGxpdFZhbC5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICAgICAgc3BsaXRWYWwuc3BsaWNlKDEsIDAsICcuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbCA9ICcnO1xyXG4gICAgICAgIHNwbGl0VmFsLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHZhbCArPSBlbGVtZW50O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb3ZlcnRNaWxsYXJXaXRoRGVjaW1hbFRvU3BhbmlzaCh2YWw6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHNwbGl0VmFsID0gdmFsLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgaWYgKHNwbGl0VmFsWzBdLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgICAgICBsZXQgbmF0dXJhbE51bSA9IHNwbGl0VmFsWzBdO1xyXG4gICAgICAgICAgICBzcGxpdFZhbFswXSA9ICcnO1xyXG4gICAgICAgICAgICBuYXR1cmFsTnVtID0gbmF0dXJhbE51bS5zcGxpdCgnJyk7XHJcbiAgICAgICAgICAgIG5hdHVyYWxOdW0uc3BsaWNlKDEsIDAsICcuJyk7XHJcbiAgICAgICAgICAgIG5hdHVyYWxOdW0uZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIHNwbGl0VmFsWzBdICs9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YWwgPSBgJHtzcGxpdFZhbFswXX0sJHtzcGxpdFZhbFsxXX1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjb3B5QXJyYXkoaXRlbSkge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIGlmICghaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgaXRlbS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh0aGlzLmNvcHlBcnJheShlbGVtZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhKGl0ZW0gaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge307XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IHRoaXMuY29weUFycmF5KGl0ZW1ba2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCBpdGVtO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjaGFyZ2VTaG93TXVsdGljaGVjayhjb25kaXRpb25hbE11bHRpY2hlY2ssIGtleXNNdWx0aWNoZWNrLCB2YWx1ZU11bHRpY2hlY2tUb0NvbXBhcmUsIGRhdGEpIHtcclxuICAgICAgICBjb25zdCBzaG93QXJyYXkgPSBbXTtcclxuICAgICAgICBkYXRhLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIHNob3dBcnJheVtpbmRleF0gPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChjb25kaXRpb25hbE11bHRpY2hlY2sgJiYga2V5c011bHRpY2hlY2sgJiYgdmFsdWVNdWx0aWNoZWNrVG9Db21wYXJlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5c011bHRpY2hlY2subGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3Vib3BlcmF0aW9uQ29uZGl0aW9uYWwoY29uZGl0aW9uYWxNdWx0aWNoZWNrW2ldLCB2YWx1ZU11bHRpY2hlY2tUb0NvbXBhcmVbaV0sIGVsZW1lbnRba2V5c011bHRpY2hlY2tbaV1dKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBzaG93QXJyYXlbaW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dBcnJheVtpbmRleF0gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNob3dBcnJheTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3Vib3BlcmF0aW9uQ29uZGl0aW9uYWwoY29uZGl0aW9uYWwsIHZhbHVlVG9Db21wYXJlLCB2YWx1ZSkge1xyXG4gICAgICAgIHN3aXRjaCAoY29uZGl0aW9uYWwpIHtcclxuICAgICAgICAgICAgY2FzZSAnPCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPCBwYXJzZUZsb2F0KHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgPiBwYXJzZUZsb2F0KHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPT09JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiAodmFsdWUgfHwgdmFsdWUgPT09IDAgfHwgdmFsdWUgPT09IGZhbHNlID8gdmFsdWUudG9TdHJpbmcoKSA6IHZhbHVlKSA9PT1cclxuICAgICAgICAgICAgICAgICAgICAodmFsdWVUb0NvbXBhcmUgfHwgdmFsdWVUb0NvbXBhcmUgPT09IDAgfHwgdmFsdWVUb0NvbXBhcmUgPT09IGZhbHNlID8gdmFsdWVUb0NvbXBhcmUudG9TdHJpbmcoKSA6IHZhbHVlVG9Db21wYXJlKTtcclxuICAgICAgICAgICAgY2FzZSAnPj0nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID49IHZhbHVlVG9Db21wYXJlO1xyXG4gICAgICAgICAgICBjYXNlICc8PSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgPD0gdmFsdWVUb0NvbXBhcmU7XHJcbiAgICAgICAgICAgIGNhc2UgJzxkYXknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSh2YWx1ZSkuc2V0SG91cnMoMCkgLSBuZXcgRGF0ZSgpLnNldEhvdXJzKDAsIDAsIDAsIDApKSA8IDA7XHJcbiAgICAgICAgICAgIGNhc2UgJz5kYXknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSh2YWx1ZSkuc2V0SG91cnMoMCkgLSBuZXcgRGF0ZSgpLnNldEhvdXJzKDAsIDAsIDAsIDApKSA+IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==