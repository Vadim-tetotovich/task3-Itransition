"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var crypto_1 = require("crypto");

function generateHash(options) {
    var secret = options.secret,
        payload = options.payload,
        timestamp = options.timestamp,
        algorithm = options.algorithm;
    return signHash(secret, payload, timestamp, algorithm);
}
exports.generateHash = generateHash;

function verifyHash(hash, options, ttl) {
    if (ttl === void 0) { ttl = 30; }
    var secret = options.secret,
        payload = options.payload,
        timestamp = options.timestamp,
        algorithm = options.algorithm;
    var validHash = signHash(secret, payload, timestamp, algorithm);
    if (validHash === hash) {
        var isTimestampValid = (new Date(timestamp)).getTime() > 0;
        if (isTimestampValid) {
            if ((new Date().getTime()) - timestamp > ttl) {
                return false;
            }
            return true;
        }
        return false;
    }
    return false;
}
exports.verifyHash = verifyHash;

function signHash(secret, payload, timestamp, algorithm) {
    var hmac = crypto_1.createHmac(algorithm, secret);
    hmac.write(payload);
    hmac.end();
    return hmac.read().toString("hex");
}
//# sourceMappingURL=index.js.map